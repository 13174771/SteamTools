<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:System.Application.UI.ViewModels;assembly=System.Application.SteamTools.Client.Desktop"
             xmlns:resx="clr-namespace:System.Application.UI.Resx;assembly=System.Application.SteamTools.Client.Desktop"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:System.Application.UI.Views.Controls"
             xmlns:i="using:Avalonia.Xaml.Interactivity"
             xmlns:ia="using:Avalonia.Xaml.Interactions.Core"
             x:Name="u"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="System.Application.UI.Views.Pages.GameListPage">
    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>
    <Grid ColumnDefinitions="Auto,*">
        <!--<TreeView Grid.Column="0">
            <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding Children}">
                    <TextBlock Text="{Binding Name}"/>
                </TreeDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>-->
        <Panel Grid.Column="1">
            <SplitView IsPaneOpen="{Binding IsAppInfoOpen,Mode=TwoWay}"
                PanePlacement="Right"
                OpenPaneLength="500"
                DisplayMode="Overlay"
                PaneBackground="Transparent">
                <SplitView.Pane>
                    <Panel>
                        <TextBlock Text="{Binding SelectApp.DisplayName}" FontSize="22"></TextBlock>
                    </Panel>
                </SplitView.Pane>
                <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" Padding="0 0 0 10">
                    <ItemsRepeater Items="{Binding SteamApps}">
                        <ItemsRepeater.Layout>
                            <UniformGridLayout ItemsJustification="SpaceEvenly" MinRowSpacing="20"  MaximumRowsOrColumns="8"/>
                        </ItemsRepeater.Layout>
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Margin="20 0" Spacing="8">
                                    <Border DockPanel.Dock="Top" Classes="paper" x:Name="app" Cursor="Hand">
                                        <i:Interaction.Behaviors>
                                            <ia:EventTriggerBehavior EventName="PointerPressed" SourceObject="{Binding #app}">
                                                <ia:InvokeCommandAction Command="{Binding #u.DataContext.AppClick}" CommandParameter="{Binding}"/>
                                            </ia:EventTriggerBehavior>
                                        </i:Interaction.Behaviors>
                                        <Panel Width="200" Height="300">
                                            <Image Stretch="UniformToFill" Source="{Binding DefaultLibraryLogo,Converter={StaticResource BitmapAssetValueConverter}}"/>
                                            <Image Stretch="UniformToFill" Source="{Binding LibraryLogoStream,Converter={StaticResource BitmapAssetValueConverter}}" IsVisible="{Binding !LibraryLogoStream,Converter={StaticResource IsNullConverter}}"/>

                                            <Panel Width="200" IsVisible="{Binding LibraryLogoStream,Converter={StaticResource IsNullConverter}}">
                                                <Image Stretch="Uniform" Source="{Binding HeaderLogoStream,Converter={StaticResource BitmapAssetValueConverter}}" Opacity="0.8" IsVisible="{Binding !HeaderLogoStream,Converter={StaticResource IsNullConverter}}"/>

                                                <TextBlock
                                                    Text="{Binding DisplayName}"
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Center"
                                                    TextWrapping="WrapWithOverflow"
                                                    FontSize="20" IsVisible="{Binding HeaderLogoStream,Converter={StaticResource IsNullConverter}}"
                                                    Foreground="{DynamicResource HighlightForegroundBrushKey}"/>
                                            </Panel>

                                            <TextBlock Text="{Binding AppId}" HorizontalAlignment="Center" VerticalAlignment="Bottom"></TextBlock>
                                        </Panel>
                                    </Border>

                                    <controls:ScrollingTextBlock Width="{Binding $parent.Width}" Text="{Binding DisplayName}" FontSize="12" FontWeight="Bold" Foreground="{DynamicResource HighlightForegroundBrushKey}"/>
                                    <!--<controls:ScrollingTextBlock Width="{Binding $parent.Width}" Text="{Binding AppId}" FontSize="10" Foreground="{DynamicResource InactiveForegroundBrushKey}" />-->
                                </StackPanel>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </ScrollViewer>
            </SplitView>
        </Panel>
    </Grid>
</UserControl>